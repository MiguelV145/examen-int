import{a as L,b as j}from"./chunk-5LGPVQE3.js";import{h as G}from"./chunk-WIXUQZML.js";import{a as I,b as c,c as P,d as H,f as V,g as O,h as w,i as F,j as W,k as $,l as R,n as q}from"./chunk-ADR736PP.js";import{Ca as D,Na as _,P as u,Pa as h,Qa as T,Qb as k,Ra as y,Sa as E,T as S,Ta as g,U as x,Ua as i,Va as e,Wa as m,ab as M,da as s,db as b,fb as f,lb as A,mb as N,nb as o,ob as d,pb as C,ra as r}from"./chunk-ZLGDGVDP.js";var U=(n,a)=>a.id;function z(n,a){if(n&1&&(i(0,"option",11),o(1),e()),n&2){let t=a.$implicit;g("value",t),r(),d(t)}}function J(n,a){n&1&&m(0,"span",19)}function K(n,a){n&1&&o(0," Agregar Horario ")}function Q(n,a){n&1&&(i(0,"div",21),m(1,"span",24),e())}function X(n,a){n&1&&(i(0,"div",22)(1,"span"),o(2,"No tienes horarios configurados a\xFAn."),e()())}function Y(n,a){if(n&1){let t=M();i(0,"tr")(1,"td"),o(2),e(),i(3,"td"),o(4),e(),i(5,"td"),o(6),e(),i(7,"td"),o(8),e(),i(9,"td")(10,"div",26),o(11),e()(),i(12,"td",27)(13,"button",28),b("click",function(){let p=S(t).$implicit,v=f(2);return x(v.toggleSlot(p))}),o(14),e(),i(15,"button",29),b("click",function(){let p=S(t).$implicit,v=f(2);return x(v.deleteSlot(p.id))}),o(16," Eliminar "),e()()()}if(n&2){let t=a.$implicit;r(2),d(t.dayOfWeek),r(2),d(t.startTime),r(2),d(t.endTime),r(2),d(t.modality),r(2),N(t.enabled?"badge-success":"badge-error"),r(),C(" ",t.enabled?"Activo":"Inactivo"," "),r(2),A("btn-success",!t.enabled)("btn-warning",t.enabled),r(),C(" ",t.enabled?"Desactivar":"Activar"," ")}}function Z(n,a){if(n&1&&(i(0,"div",23)(1,"table",25)(2,"thead")(3,"tr")(4,"th"),o(5,"D\xEDa"),e(),i(6,"th"),o(7,"Hora inicio"),e(),i(8,"th"),o(9,"Hora fin"),e(),i(10,"th"),o(11,"Modalidad"),e(),i(12,"th"),o(13,"Estado"),e(),i(14,"th"),o(15,"Acciones"),e()()(),i(16,"tbody"),y(17,Y,17,12,"tr",null,U),e()()()),n&2){let t=f();r(17),E(t.slots())}}var B=class n{fb=u(R);availabilityApi=u(L);toastr=u(G);loading=s(!1);loadingSlots=s(!1);creatingSlot=s(!1);slots=s([]);daysOfWeek=Object.values(j);form=this.fb.group({dayOfWeek:["",c.required],startTime:["",c.required],endTime:["",c.required],modality:["VIRTUAL",c.required]});ngOnInit(){this.loadSlots()}loadSlots(){this.loadingSlots.set(!0),this.availabilityApi.getMySlots().subscribe({next:a=>{this.slots.set(a),this.loadingSlots.set(!1)},error:a=>{this.toastr.error(this.getErrorMessage(a,"No se pudieron cargar los horarios.")),this.loadingSlots.set(!1)}})}onSubmit(){if(this.form.invalid)return;this.creatingSlot.set(!0);let a={dayOfWeek:this.form.get("dayOfWeek")?.value,startTime:this.form.get("startTime")?.value||"",endTime:this.form.get("endTime")?.value||"",modality:this.form.get("modality")?.value};this.availabilityApi.createSlot(a).subscribe({next:t=>{this.toastr.success("Horario agregado correctamente"),this.form.reset({modality:"VIRTUAL"}),this.creatingSlot.set(!1),this.loadSlots()},error:t=>{this.toastr.error(this.getErrorMessage(t,"No se pudo agregar el horario.")),this.creatingSlot.set(!1)}})}toggleSlot(a){this.availabilityApi.updateSlot(a.id,{enabled:!a.enabled}).subscribe({next:()=>{this.toastr.success("Estado actualizado"),this.loadSlots()},error:t=>{this.toastr.error(this.getErrorMessage(t,"No se pudo actualizar el estado."))}})}deleteSlot(a){confirm("\xBFEst\xE1s seguro de que deseas eliminar este horario?")&&this.availabilityApi.deleteSlot(a).subscribe({next:()=>{this.toastr.success("Horario eliminado"),this.loadSlots()},error:t=>{this.toastr.error(this.getErrorMessage(t,"No se pudo eliminar el horario."))}})}getErrorMessage(a,t){let l=a?.error?.message||a?.error?.details;return l||(a?.status?`Error ${a.status}: ${a.statusText||t}`:a?.message?.includes("Network")?"Error de conexion. Verifica tu conexion a internet.":t)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=D({type:n,selectors:[["app-disponibilidad-programador"]],decls:50,vars:4,consts:[[1,"container","mx-auto","px-4","py-8"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-8"],[1,"card","bg-base-100","shadow-lg"],[1,"card-body"],[1,"card-title"],[1,"space-y-4",3,"ngSubmit","formGroup"],[1,"form-control"],[1,"label"],[1,"label-text"],["formControlName","dayOfWeek",1,"select","select-bordered"],["value","","disabled",""],[3,"value"],["type","time","formControlName","startTime",1,"input","input-bordered"],["type","time","formControlName","endTime",1,"input","input-bordered"],["formControlName","modality",1,"select","select-bordered"],["value","PRESENCIAL"],["value","VIRTUAL"],["value","HIBRIDA"],["type","submit",1,"btn","btn-primary","w-full",3,"disabled"],[1,"loading","loading-spinner","loading-xs"],[1,"lg:col-span-2"],[1,"flex","justify-center","py-8"],[1,"alert","alert-info"],[1,"overflow-x-auto"],[1,"loading","loading-spinner","loading-lg"],[1,"table","table-sm"],[1,"badge"],[1,"space-x-2"],[1,"btn","btn-xs",3,"click"],[1,"btn","btn-xs","btn-error",3,"click"]],template:function(t,l){t&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2",4),o(5,"Agregar Horario"),e(),i(6,"form",5),b("ngSubmit",function(){return l.onSubmit()}),i(7,"div",6)(8,"label",7)(9,"span",8),o(10,"D\xEDa de la semana"),e()(),i(11,"select",9)(12,"option",10),o(13,"Selecciona un d\xEDa"),e(),y(14,z,2,2,"option",11,T),e()(),i(16,"div",6)(17,"label",7)(18,"span",8),o(19,"Hora inicio (HH:MM)"),e()(),m(20,"input",12),e(),i(21,"div",6)(22,"label",7)(23,"span",8),o(24,"Hora fin (HH:MM)"),e()(),m(25,"input",13),e(),i(26,"div",6)(27,"label",7)(28,"span",8),o(29,"Modalidad"),e()(),i(30,"select",14)(31,"option",10),o(32,"Selecciona una modalidad"),e(),i(33,"option",15),o(34,"Presencial"),e(),i(35,"option",16),o(36,"Virtual"),e(),i(37,"option",17),o(38,"H\xEDbrida"),e()()(),i(39,"button",18),_(40,J,1,0,"span",19)(41,K,1,0),e()()()(),i(42,"div",20)(43,"div",2)(44,"div",3)(45,"h2",4),o(46,"Mis Horarios de Disponibilidad"),e(),_(47,Q,2,0,"div",21)(48,X,3,0,"div",22)(49,Z,19,0,"div",23),e()()()()()),t&2&&(r(6),g("formGroup",l.form),r(8),E(l.daysOfWeek),r(25),g("disabled",l.form.invalid||l.creatingSlot()),r(),h(l.creatingSlot()?40:41),r(7),h(l.loadingSlots()?47:l.slots().length===0?48:49))},dependencies:[k,q,V,W,$,I,F,P,H,w,O],encapsulation:2,changeDetection:0})};export{B as DisponibilidadProgramadorComponent};

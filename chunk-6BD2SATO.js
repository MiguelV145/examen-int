import{a as D}from"./chunk-XHPOVNHJ.js";import{h}from"./chunk-WB6SC5GS.js";import{$a as v,Ba as _,Ma as l,O as p,Oa as c,Pb as S,Qa as C,Ra as A,S as x,T as f,Wa as a,Xa as i,Ya as E,ca as g,db as b,eb as d,lb as M,mb as n,nb as u,ob as m,qa as o}from"./chunk-EH3YIYIB.js";var I=(s,t)=>t.id;function w(s,t){s&1&&(a(0,"div",2),E(1,"span",5),i())}function F(s,t){s&1&&(a(0,"div",3)(1,"span"),n(2,"No tienes asesor\xEDas. \xA1Crea una!"),i()())}function R(s,t){if(s&1&&(a(0,"div",13)(1,"p",16),n(2,"Notas:"),i(),a(3,"p",17),n(4),i()()),s&2){let e=d().$implicit;o(4),u(e.notes)}}function $(s,t){if(s&1){let e=v();a(0,"button",18),b("click",function(){x(e);let T=d().$implicit,y=d(2);return f(y.cancelAsesoria(T.id))}),n(1," Cancelar "),i()}}function k(s,t){if(s&1&&(a(0,"div",6)(1,"div",7)(2,"div",8),n(3),i(),a(4,"p",9),n(5),i(),E(6,"div",10),a(7,"div",11)(8,"p")(9,"span",12),n(10,"Fecha:"),i(),n(11),i(),a(12,"p")(13,"span",12),n(14,"Duraci\xF3n:"),i(),n(15),i(),a(16,"p")(17,"span",12),n(18,"Modalidad:"),i(),n(19),i(),a(20,"p")(21,"span",12),n(22,"Programador:"),i(),n(23),i()(),l(24,R,5,1,"div",13),a(25,"div",14),l(26,$,2,0,"button",15),i()()()),s&2){let e=t.$implicit,r=d(2);o(2),M(r.getStatusBadgeClass(e.status)),o(),m(" ",e.status," "),o(2),u(e.topic||"Sin tema"),o(6),m(" ",r.formatDateTime(e.startAt)," "),o(4),m(" ",e.durationMinutes," minutos "),o(4),m(" ",e.modality," "),o(4),m(" ",(e.programmer==null?null:e.programmer.displayName)||(e.programmer==null?null:e.programmer.username)," "),o(),c(e.notes?24:-1),o(2),c(e.status==="PENDIENTE"?26:-1)}}function L(s,t){if(s&1&&(a(0,"div",4),C(1,k,27,10,"div",6,I),i()),s&2){let e=d();o(),A(e.asesorias())}}var N=class s{asesoriasApi=p(D);toastr=p(h);loading=g(!1);asesorias=g([]);ngOnInit(){this.loadAsesorias()}loadAsesorias(){this.loading.set(!0),this.asesoriasApi.getMisAsesoriasAsClient().subscribe({next:t=>{this.asesorias.set(t),this.loading.set(!1)},error:t=>{this.toastr.error(this.getErrorMessage(t,"No se pudieron cargar las asesor\xEDas.")),this.loading.set(!1)}})}cancelAsesoria(t){confirm("\xBFEst\xE1s seguro de que deseas cancelar esta asesor\xEDa?")&&this.asesoriasApi.cancelAsesoria(t).subscribe({next:()=>{this.toastr.success("Asesor\xEDa cancelada"),this.loadAsesorias()},error:e=>{this.toastr.error(this.getErrorMessage(e,"No se pudo cancelar la asesor\xEDa."))}})}getErrorMessage(t,e){let r=t?.error?.message||t?.error?.details;return r||(t?.status?`Error ${t.status}: ${t.statusText||e}`:t?.message?.includes("Network")?"Error de conexion. Verifica tu conexion a internet.":e)}getStatusBadgeClass(t){return{PENDIENTE:"badge-warning",CONFIRMADA:"badge-info",EN_CURSO:"badge-primary",COMPLETADA:"badge-success",CANCELADA:"badge-error",RECHAZADA:"badge-error"}[t]||"badge-default"}formatDateTime(t){let e=new Date(t);return e.toLocaleDateString()+" "+e.toLocaleTimeString()}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=_({type:s,selectors:[["app-mis-asesorias"]],decls:6,vars:1,consts:[[1,"container","mx-auto","px-4","py-8"],[1,"text-3xl","font-bold","mb-6"],[1,"flex","justify-center","py-8"],[1,"alert","alert-info"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-4"],[1,"loading","loading-spinner","loading-lg"],[1,"card","bg-base-100","shadow-lg"],[1,"card-body"],[1,"badge"],[1,"font-semibold","text-lg"],[1,"divider","my-2"],[1,"space-y-2","text-sm"],[1,"font-semibold"],[1,"mt-3"],[1,"card-actions","mt-4"],[1,"btn","btn-sm","btn-error"],[1,"text-xs","opacity-75"],[1,"text-sm"],[1,"btn","btn-sm","btn-error",3,"click"]],template:function(e,r){e&1&&(a(0,"div",0)(1,"h1",1),n(2,"Mis Asesor\xEDas"),i(),l(3,w,2,0,"div",2)(4,F,3,0,"div",3)(5,L,3,0,"div",4),i()),e&2&&(o(3),c(r.loading()?3:r.asesorias().length===0?4:5))},dependencies:[S],encapsulation:2,changeDetection:0})};export{N as MisAsesoriasComponent};
